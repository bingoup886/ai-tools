# 🚀 Geek工具导航站

一个现代化的工具导航网站，支持分类管理、投票排名、拖拽排序、维护模式等功能。基于 Cloudflare Pages + D1 数据库，完全免费部署！

## 📌 项目概述

**项目名称**: geek-tools (Geek工具导航站)

**核心定位**: 为极客和开发者打造的工具导航平台，支持社区投票排名和灵活的管理系统。

**部署架构**: Cloudflare Pages + Cloudflare Workers + Cloudflare D1

## ✨ 核心功能

### 🎯 已实现功能

#### 1. **分类管理**

- ✅ 创建、编辑、删除工具分类
- ✅ 分类拖拽排序
- ✅ 分类自动排序持久化

#### 2. **工具管理**

- ✅ 在分类下添加/编辑/删除工具
- ✅ 工具拖拽排序
- ✅ 支持工具名称、URL、描述等信息
- ✅ 工具排序持久化

#### 3. 投票系统

- ✅ 点赞/点踩功能（👍 👎）
- ✅ 实时投票统计
- ✅ 投票状态切换（支持取消投票）
- ✅ 基于IP和用户名的投票追踪
- ✅ 投票不影响工具排序（保持手动排序稳定性）

#### 4. 维护模式

- ✅ 密码保护的后台管理系统
- ✅ MD5加密密码验证
- ✅ 展示模式/维护模式切换
- ✅ 拖拽排序功能
- ✅ 隐藏式管理员模式（点击Logo 5次进入）

#### 5. 前端交互

- ✅ 响应式设计
- ✅ 直观的拖拽交互
- ✅ 实时数据更新
- ✅ 流畅的用户体验

### 🔮 计划中的功能

- 用户系统（注册、登录、权限管理）
- 评论系统（全站评论、评论点赞、评论审核）
- 浏览记录和访问统计
- 用户行为分析
- 高级搜索/过滤功能

## 🏗️ 项目架构

```
┌─────────────────────────────────┐
│     前端 (React + Vite)          │
│  - CategoryCard (分类卡片)       │
│  - ToolCard (工具卡片)           │
│  - Modal组件 (模态框)            │
│  - 拖拽排序功能                  │
└────────────────┬────────────────┘
                 │ API 调用
                 ↓
┌─────────────────────────────────┐
│   Cloudflare Workers (API层)     │
│  - /api/categories (分类CRUD)    │
│  - /api/tools (工具CRUD)         │
│  - /api/votes (投票操作)         │
│  - /api/sort (排序管理)          │
│  - /api/tags (标签CRUD)          │
│  - /api/tool-tags (工具标签关联) │
└────────────────┬────────────────┘
                 │ 数据操作
                 ↓
┌─────────────────────────────────┐
│   Cloudflare D1 (SQLite数据库)   │
│  - categories (分类表)           │
│  - tools (工具表)                │
│  - votes (投票表)                │
└─────────────────────────────────┘
```

## 🗄️ 数据库设计

### 已实现的表

| 表名           | 用途   | 关键字段                                          |
|--------------|------|-----------------------------------------------|
| `categories` | 工具分类 | id, name, sort_order                          |
| `tools`      | 工具数据 | id, category_id, name, url, sort_order        |
| `votes`      | 投票记录 | id, tool_id, vote_type, user_name, ip_address |

### 已实现的表（标签系统）

| 表名           | 用途       | 关键字段                                  |
|--------------|-----------|----------------------------------------|
| `tags`       | 标签数据   | id, name, slug, color, sort_order      |
| `tool_tags`  | 工具标签关联 | tool_id, tag_id, created_at            |

### 预留的表（未实现）

| 表名              | 用途     |
|-----------------|--------|
| `users`         | 用户系统   |
| `comments`      | 评论系统   |
| `comment_likes` | 评论点赞   |
| `view_logs`     | 浏览记录   |

## 🛠️ 技术栈

### 前端

- **React** 19.2.3 - UI框架
- **Vite** 7.3.0 - 构建工具
- **SortableJS** 1.15.6 - 拖拽排序库
- **CryptoJS** 4.2.0 - 密码加密

### 后端

- **Cloudflare Workers** - 无服务器计算
- **Cloudflare D1** - SQLite数据库
- **Cloudflare Pages** - 静态托管

### 开发环境

- **Node.js** >= 20.0.0

## 🚀 快速开始

### 前置要求

- Node.js >= 20.0.0
- npm 或 yarn
- Cloudflare账户

### 本地开发

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 访问 http://localhost:5173
```

开发服务器会自动代理 `/api` 请求到 `http://localhost:8787`（本地Workers）。

### 生产构建

```bash
# 构建项目
npm run build

# 预览构建结果
npm run preview
```

## 🌐 部署到Cloudflare

### 1. 配置Cloudflare Pages

在 Cloudflare Dashboard 中配置以下参数：

- **Framework preset**: None / Custom
- **Build command**: `npm run build`
- **Build output directory**: `dist`
- **Root directory**: `/`

### 2. 配置D1数据库

```bash
# 初始化D1数据库
npx wrangler d1 create geek-tools-db

# 执行schema
npx wrangler d1 execute geek-tools-db --file=./db/schema.sql
```

### 3. 部署

推送到Git仓库后，Cloudflare Pages会自动构建和部署。

## 🔐 维护密码与管理员模式

### 维护密码

维护模式使用MD5加密的密码。当前密码哈希值存储在 `src/hooks/usePassword.js` 中。

修改密码步骤：

1. 计算新密码的MD5哈希值
2. 更新 `PASSWORD_HASH` 常量
3. 重新部署

### 隐藏式管理员模式 (v1.4.1+)

为了隐蔽地为管理员提供进入维护模式的方式，系统实现了一个隐藏的管理员激活机制：

#### 如何进入维护模式？

**对于普通用户**：
- 看不到任何维护模式的按钮或提示
- 展示模式下界面完全清爽

**对于管理员**：
- 在展示模式下，**点击页面 Logo（🚀 Geek工具导航站）5 次**
- 系统会显示"✨ 管理员模式已激活！"的脉冲提示动画
- 自动弹出密码验证框
- 输入正确密码后进入维护模式

#### 技术细节

- **触发条件**：5次点击（3秒内无新点击则重置计数）
- **视觉反馈**：
  - Logo 添加鼠标悬停效果（放大 + 透明度变化）
  - 激活时显示脉冲动画提示
- **实现方式**：`useAdminMode` Hook 管理点击状态
- **安全性**：需要密码验证，完全隐蔽

#### 为什么采用这种方式？

- ✅ **隐蔽**：普通用户完全看不到
- ✅ **易用**：管理员可快速进入，无需额外操作
- ✅ **专业**：类似iOS"开发者模式"的激活方式
- ✅ **安全**：多重保护（隐蔽 + 密码）

## 📊 功能完成度

| 功能模块 | 完成度  | 状态    |
|------|------|-------|
| 分类管理 | 100% | ✅ 完成  |
| 工具管理 | 100% | ✅ 完成  |
| 投票系统 | 100% | ✅ 完成  |
| 排序系统 | 100% | ✅ 完成  |
| 维护模式 | 100% | ✅ 完成  |
| 标签系统 | 100% | ✅ 完成  |
| 隐藏式管理员模式 | 100% | ✅ 完成  |
| 前端UI | 100% | ✅ 完成  |
| 用户系统 | 0%   | ⏳ 计划中 |
| 评论系统 | 0%   | ⏳ 计划中 |
| 浏览统计 | 0%   | ⏳ 计划中 |

## 🎨 特色功能

### 稳定排序系统

- **完全手动排序**：工具展示顺序完全由管理员拖拽决定
- **投票不干扰**：用户的点赞/点踩操作不会导致工具位置跳动
- **实时保存**：拖拽排序后立即保存到数据库

### 智能投票统计

- 实时更新点赞/点踩数据
- 支持投票切换和取消
- 基于IP和用户名的投票追踪

### 拖拽排序

- 分类和工具都支持拖拽排序
- 仅在维护模式下启用
- 排序立即保存到数据库

### 密码保护

- 维护模式需要密码验证
- 使用MD5加密
- 安全的后台管理

## 📝 开发指南

### 添加新的API端点

1. 在 `functions/api/` 下创建新文件
2. 实现 `onRequestGet/Post/Put/Delete` 函数
3. 在 `useData.js` 中添加对应的hook方法

### 添加新的组件

1. 在 `src/components/` 下创建新的 `.jsx` 文件
2. 使用React Hooks管理状态
3. 在 `App.jsx` 中导入并使用

### 修改样式

编辑 `src/styles/index.css` 文件，支持全局样式定制。

## 🐛 已知问题

- 暂无已知问题

## 📄 许可证

ISC

## 👨‍💻 贡献指南

欢迎提交Issue和Pull Request！

## 📞 联系方式

如有问题或建议，欢迎通过以下方式联系：

- 提交GitHub Issue
- 发送邮件

---

**最后更新**: 2026年1月4日

**项目状态**: 🟢 活跃开发中

**当前版本**: v2.0.1 - 优化排序逻辑与代码结构

